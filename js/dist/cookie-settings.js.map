{"version":3,"file":"cookie-settings.js","sources":["../../react/src/components/CookieSettings.tsx","../../react/src/entries/cookie-settings.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\n\ninterface ConsentPreferences {\n  essential: boolean;\n  analytics: boolean;\n  marketing: boolean;\n}\n\nconst STORAGE_KEY = 'tme_cookie_consent_v1';\n\nfunction loadPreferences(): ConsentPreferences | null {\n  try {\n    const raw = localStorage.getItem(STORAGE_KEY);\n    if (!raw) return null;\n    const parsed = JSON.parse(raw);\n    return {\n      essential: true,\n      analytics: Boolean(parsed.analytics),\n      marketing: Boolean(parsed.marketing),\n    };\n  } catch {\n    return null;\n  }\n}\n\nfunction savePreferences(prefs: ConsentPreferences): void {\n  localStorage.setItem(\n    STORAGE_KEY,\n    JSON.stringify({\n      analytics: prefs.analytics,\n      marketing: prefs.marketing,\n      timestamp: Date.now(),\n    })\n  );\n  // Notify legacy consent bridge\n  const consentApi = window.TheMoonExports?.Consent;\n  if (consentApi?.onReady) {\n    consentApi.onReady(() => ({ analytics: prefs.analytics, timestamp: Date.now() }));\n  }\n}\n\nconst CookieSettings: React.FC = () => {\n  const [open, setOpen] = useState(false);\n  const [prefs, setPrefs] = useState<ConsentPreferences>(() => loadPreferences() ?? { essential: true, analytics: false, marketing: false });\n\n  useEffect(() => {\n    const saved = loadPreferences();\n    if (saved) setPrefs(saved);\n  }, []);\n\n  const handleToggle = (key: 'analytics' | 'marketing') => {\n    setPrefs((prev) => ({ ...prev, [key]: !prev[key] }));\n  };\n\n  const handleSave = () => {\n    savePreferences(prefs);\n    setOpen(false);\n  };\n\n  if (!open) {\n    return (\n      <button\n        className=\"cookie-settings-trigger btn-crafts btn-crafts--sm\"\n        onClick={() => setOpen(true)}\n        aria-label=\"Cookie settings\"\n      >\n        <i className=\"fas fa-cookie-bite\" aria-hidden=\"true\"></i> Cookie Settings\n      </button>\n    );\n  }\n\n  return (\n    <div className=\"cookie-settings-panel card-crafts\" role=\"dialog\" aria-label=\"Cookie preferences\">\n      <h3>Cookie Preferences</h3>\n      <p>Manage your cookie preferences below. Essential cookies are always active.</p>\n      <ul className=\"cookie-settings-list\">\n        <li className=\"cookie-settings-item\">\n          <label className=\"cookie-settings-label\">\n            <input type=\"checkbox\" checked disabled aria-label=\"Essential cookies (always on)\" />\n            <span><strong>Essential</strong> — Required for site functionality</span>\n          </label>\n        </li>\n        <li className=\"cookie-settings-item\">\n          <label className=\"cookie-settings-label\">\n            <input\n              type=\"checkbox\"\n              checked={prefs.analytics}\n              onChange={() => handleToggle('analytics')}\n              aria-label=\"Analytics cookies\"\n            />\n            <span><strong>Analytics</strong> — Help us understand site usage</span>\n          </label>\n        </li>\n        <li className=\"cookie-settings-item\">\n          <label className=\"cookie-settings-label\">\n            <input\n              type=\"checkbox\"\n              checked={prefs.marketing}\n              onChange={() => handleToggle('marketing')}\n              aria-label=\"Marketing cookies\"\n            />\n            <span><strong>Marketing</strong> — Used for targeted advertising</span>\n          </label>\n        </li>\n      </ul>\n      <div className=\"cookie-settings-actions\">\n        <button className=\"btn-crafts\" onClick={handleSave}>Save Preferences</button>\n        <button className=\"btn-crafts btn-crafts--sm\" onClick={() => setOpen(false)}>Cancel</button>\n      </div>\n    </div>\n  );\n};\n\nexport default CookieSettings;\n","import React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport CookieSettings from '../components/CookieSettings';\n\nconst mount = document.querySelector('[data-react=\"cookie-settings\"]');\nif (mount) {\n  createRoot(mount).render(<CookieSettings />);\n}\n"],"names":["STORAGE_KEY","loadPreferences","raw","parsed","savePreferences","prefs","consentApi","_a","CookieSettings","open","setOpen","useState","setPrefs","useEffect","saved","handleToggle","key","prev","handleSave","jsx","jsxs","mount","createRoot"],"mappings":"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"}
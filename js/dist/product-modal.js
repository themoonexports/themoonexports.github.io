import{j as t,c as w}from"./chunks/client-oktmLSNA.js";import{r as i}from"./chunks/index-CVf8TyFT.js";function M(){const[n,c]=i.useState([]),[x,l]=i.useState(!0),[j,h]=i.useState(null);i.useEffect(()=>{fetch("/products.json").then(e=>{if(!e.ok)throw new Error("Failed to load products.json");return e.json()}).then(e=>{const u=e.map(r=>{const s=Array.isArray(r.images)?r.images.slice():[];if(r.image&&(!s.length||s[0]!==r.image)){const f=s.filter(p=>p!==r.image);s.splice(0,s.length,r.image,...f)}return{...r,images:s}}).sort((r,s)=>{const f=p=>{const v=(p||"").match(/TME-(\d+)/i);return v?parseInt(v[1],10):Number.MAX_SAFE_INTEGER};return f(r.productId)-f(s.productId)});c(u),l(!1)}).catch(e=>{h(e.message),l(!1)})},[]);const d=i.useMemo(()=>new Map(n.map(e=>[e.id,e])),[n]),g=i.useMemo(()=>new Map(n.map(e=>[e.productId,e])),[n]),b=i.useMemo(()=>n.reduce((e,u)=>{var r;return(e[r=u.category]||(e[r]=[])).push(u),e},{}),[n]);return{products:n,byId:d,byProductId:g,byCategory:b,loading:x,error:j}}function E(){const n=(document.documentElement.getAttribute("lang")||"en").toLowerCase();return n.startsWith("de")?"de":n.startsWith("fr")?"fr":"en"}function N(n,c){return c==="de"&&n.name_de?n.name_de:c==="fr"&&n.name_fr?n.name_fr:n.name}function k(n,c){return c==="de"&&n.description_de?n.description_de:c==="fr"&&n.description_fr?n.description_fr:n.description}const A=()=>{const{products:n,loading:c,error:x}=M(),[l,j]=i.useState(null),[h,d]=i.useState(0),[g,b]=i.useState(null),e=E(),u=i.useMemo(()=>n.slice(0,6),[n]);i.useEffect(()=>{if(l===null)return;const a=o=>{o.key==="Escape"&&j(null),o.key==="ArrowRight"&&d(m=>m+1),o.key==="ArrowLeft"&&d(m=>Math.max(0,m-1))};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[l]);const r=l!==null?u[l]:null,s=i.useMemo(()=>{if(!r)return[];const a=r.images&&r.images.length>0?r.images:[r.image];if(g){const o=a.indexOf(g);if(o>0){const m=a.slice(),[y]=m.splice(o,1);return m.unshift(y),m}}return a},[r,g]);i.useEffect(()=>{d(0),b(null)},[l]);const f=()=>d(a=>Math.min(a+1,Math.max(0,s.length-1))),p=()=>d(a=>Math.max(0,a-1)),v=e==="de"?"Wird geladen…":e==="fr"?"Chargement…":"Loading…";return t.jsxs("div",{className:"product-modal","data-react":"product-modal",children:[t.jsx("h2",{children:e==="de"?"Ausgewählte Produkte":e==="fr"?"Produits en vedette":"Featured Products"}),c&&t.jsx("p",{"aria-live":"polite",children:v}),x&&t.jsx("p",{role:"alert",children:x}),!c&&!x&&t.jsx("ul",{className:"product-list",children:u.map((a,o)=>t.jsx("li",{children:t.jsx("button",{className:"product-btn btn-crafts",onClick:()=>j(o),children:N(a,e)})},a.productId))}),r&&t.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",children:t.jsxs("div",{className:"modal-content card-crafts",children:[t.jsx("button",{className:"close-btn btn-icon-crafts",onClick:()=>j(null),"aria-label":e==="de"?"Schließen":e==="fr"?"Fermer":"Close",children:"×"}),t.jsx("h3",{children:N(r,e)}),t.jsx("p",{children:k(r,e)}),t.jsxs("div",{className:"lightbox",children:[t.jsxs("div",{className:"lightbox-main",children:[t.jsx("img",{src:s[Math.min(h,s.length-1)],alt:N(r,e),width:400,height:300}),t.jsxs("div",{className:"lightbox-controls",children:[t.jsx("button",{onClick:p,"aria-label":e==="de"?"Vorheriges Bild":e==="fr"?"Image précédent":"Previous image",className:"btn-icon-crafts",children:"‹"}),t.jsxs("span",{className:"lightbox-index",children:[Math.min(h,s.length-1)+1,"/",s.length]}),t.jsx("button",{onClick:f,"aria-label":e==="de"?"Nächstes Bild":e==="fr"?"Image suivant":"Next image",className:"btn-icon-crafts",children:"›"})]})]}),s.length>1&&t.jsx("ul",{className:"lightbox-thumbs","aria-label":e==="de"?"Bildergalerie":e==="fr"?"Galerie d’images":"Image gallery",children:s.map((a,o)=>t.jsx("li",{children:t.jsx("button",{className:o===h?"thumb active":"thumb",onClick:()=>d(o),"aria-current":o===h,children:t.jsx("img",{src:a,alt:"",width:72,height:54})})},a))})]}),r.variants&&r.variants.length>0&&t.jsxs("div",{className:"variants",children:[t.jsx("h4",{children:e==="de"?"Varianten":e==="fr"?"Variantes":"Variants"}),t.jsx("ul",{className:"variant-list",children:r.variants.map(a=>t.jsx("li",{children:t.jsx("button",{className:g===a.image?"variant chip-crafts active":"variant chip-crafts",onClick:()=>b(a.image),children:a.name})},a.id))})]})]})})]})},I=document.querySelector('.product-modal[data-react="product-modal"]');I&&w(I).render(t.jsx(A,{}));
//# sourceMappingURL=product-modal.js.map
